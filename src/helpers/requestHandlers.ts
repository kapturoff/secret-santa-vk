import { ClientInfo, MessageResponse, Room } from '../interfaces'
import Markup from 'node-vk-bot-api/lib/markup'

function greeterHandler(joinedRooms?: Room[]): MessageResponse {
	return {
		text: `–û-—Ö–æ-—Ö–æ, –ø—Ä–∏–≤–µ—Ç! üéÖ
–Ø ‚Äî –±–æ—Ç, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –ø—Ä–æ–≤–µ—Å—Ç–∏ –∏–≥—Ä—É "–¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞" –Ω–µ –≤—ã—Ö–æ–¥—è –∏–∑ –í–ö.
${
	joinedRooms
		? '\n–í–æ—Ç —Å–ø–∏—Å–æ–∫ –∫–æ–º–Ω–∞—Ç, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã —É–∂–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ:\n' +
		  joinedRooms
				.map((room: Room) => `- ${room.name} (${room.code})`)
				.join('\n') +
		  '\n'
		: ''
}
–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É –∏–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –Ω–µ–π, –Ω–∞–∂–º–∏ –Ω–∞ –æ–¥–Ω—É –∏–∑ –∫–Ω–æ–ø–æ–∫ –Ω–∏–∂–µ.`,
		buttons: [
			Markup.button({
				color: 'positive',
				action: {
					label: '–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É',
					payload: { action: 'createRoom' },
				},
			}),
			Markup.button({
				color: 'secondary',
				action: {
					label: '–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ',
					payload: { action: 'joinRoom' },
				},
			}),
			Markup.button({
				color: 'negative',
				action: {
					label: '–ß—Ç–æ —Ç–∞–∫–æ–µ "–¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞"?',
					payload: { action: 'help' },
				},
			}),
		],
	} as MessageResponse
}

function roomChooseNameHandler(): MessageResponse {
	return {
		text: `–ö–∞–∫ —Ç—ã –Ω–∞–∑–æ–≤—ë—à—å —Å–≤–æ—é –∫–æ–º–Ω–∞—Ç—É?`,
	} as MessageResponse
}

function createdRoomHandler(
	clientInfo: ClientInfo,
	room: Room
): MessageResponse {
	return {
		text: `–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã —Å–æ–∑–¥–∞–ª –∫–æ–º–Ω–∞—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è "–¢–∞–π–Ω–æ–≥–æ –°–∞–Ω—Ç—ã"!
–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã: "${room.name}", –µ—ë –∫–æ–¥: ${room.code}.

–ß—Ç–æ–±—ã –∫ –Ω–µ–π –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å —Ç–≤–æ–∏ –¥—Ä—É–∑—å—è, –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞, –Ω–∞–∂–∞—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ", –∞ –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –¥–∏–∞–ª–æ–≥ —Å –±–æ—Ç–æ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥: ${
			room.code
		}.
–ê –≤—Å—ë, —á—Ç–æ —Ç–µ–ø–µ—Ä—å —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç —Ç–µ–±—è ‚Äî —Ä–∞–∑–æ—Å–ª–∞—Ç—å –¥—Ä—É–∑—å—è–º –∫–æ–¥ –æ—Ç —ç—Ç–æ–π –∫–æ–º–Ω–∞—Ç—ã, –∞ –∑–∞—Ç–µ–º, –∫–æ–≥–¥–∞ –≤—Å–µ —Å–æ–±–µ—Ä—É—Ç—Å—è, –Ω–∞—á–∞—Ç—å —Ä–æ–∑—ã–≥—Ä—ã—à, ${
			clientInfo.inline_keyboard
				? '–Ω–∞–∂–∞–≤ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–æ–¥ —ç—Ç–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º'
				: '–æ—Ç–ø—Ä–∞–≤–∏–≤ –≤ –±–µ—Å–µ–¥—É —Å –±–æ—Ç–æ–º –∫–æ–º–∞–Ω–¥—É /startRoom:' + room.code
		}`,
	} as MessageResponse
}

function joinRoomHandler(): MessageResponse {
	return {
		text: `–ß—Ç–æ–±—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ, –æ—Ç–ø—Ä–∞–≤—å –±–æ—Ç—É –∫–æ–¥, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–±–æ–π –æ—Ç –¥—Ä—É–≥–∞`,
	} as MessageResponse
}

function joinedRoomHandler(room: Room): MessageResponse {
	return {
		text: `–û—Ç–ª–∏—á–Ω–æ, —è –¥–æ–±–∞–≤–∏–ª —Ç–µ–±—è –≤ –∫–æ–º–Ω–∞—Ç—É "${room.name} #${room.code}"!

–í —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ —Ç—ã –º–æ–∂–µ—à—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–≤–æ–∏—Ö –ø–æ–∂–µ–ª–∞–Ω–∏–π –¥–ª—è –ø–æ–¥–∞—Ä–∫–æ–≤. 
–≠—Ç–æ—Ç —Å–ø–∏—Å–æ–∫ —É–≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–≤–æ–π –ª–∏—á–Ω—ã–π –¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞. –ï—Å–ª–∏ —Ç—ã –Ω–µ —Ö–æ—á–µ—à—å –µ–≥–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å, –∏–ª–∏ —Ö–æ—á–µ—à—å, —á—Ç–æ–±—ã —Ç–≤–æ–π –¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞ –ø—Ä–∏–¥—É–º–∞–ª —á—Ç–æ —Ç–µ–±–µ –¥–∞—Ä–∏—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ ‚Äî –Ω–µ –±–µ–¥–∞: —Ç—ã –º–æ–∂–µ—à—å –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç —ç—Ç–∞–ø –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—É—Å—Ç—ã–º, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"`,
		buttons: [
			Markup.button({
				color: 'secondary',
				action: {
					label: '–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å',
					payload: { action: 'start' },
				},
			}),
		],
	}
}

function failedToJoinRoomHandler(code: string): MessageResponse {
	return {
		text: `–°–æ–∂–∞–ª–µ—é, –Ω–æ —è –Ω–µ —Å–º–æ–≥ –Ω–∞–π—Ç–∏ –∫–æ–º–Ω–∞—Ç—É –ø–æ–¥ –∫–æ–¥–æ–º ${code}. –í–æ–∑–º–æ–∂–Ω–æ, —Ç—ã –æ—à–∏–±—Å—è —Å –∫–æ–¥–æ–º?`,
		buttons: [
			Markup.button({
				color: 'secondary',
				action: {
					label: '–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥',
					payload: { action: 'start' },
				},
			}),
		],
	}
}

function helpHandler(): MessageResponse {
	return {
		text: `–¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞ ‚Äî –∏–≥—Ä–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –≤–µ—Å–µ–ª–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ª—é–±–æ–π –ø—Ä–∞–∑–¥–Ω–∏–∫, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –ø–æ–¥–∞—Ä–∫–∞–º–∏.

–ö–∞–∂–¥–æ–µ –†–æ–∂–¥–µ—Å—Ç–≤–æ, –ù–æ–≤—ã–π –ì–æ–¥, –∞ —Ç–∞–∫ –∂–µ –≤ –∫—É—á—É –¥—Ä—É–≥–∏—Ö —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–∑–¥–Ω–∏–∫–∞—Ö –ª—é–¥–∏ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –ø–æ–¥–∞—Ä–∫–∞–º–∏. –ß—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –µ—â—ë –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º, –º–æ–∂–Ω–æ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –ª—é–¥–µ–π –≤ –ø–∞—Ä—ã ‚Äî –¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞ –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—å –ø–æ–¥–∞—Ä–∫–æ–≤. –ö–∞–∂–¥—ã–π —á–µ–ª–æ–≤–µ–∫ –≤ —ç—Ç–æ–π –∏–≥—Ä–µ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –æ–±–µ –∏–∑ —ç—Ç–∏—Ö –¥–≤—É—Ö —Ä–æ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Äî –æ–Ω –±—É–¥–µ—Ç –∏ –∫–æ–º—É-—Ç–æ —á—Ç–æ-—Ç–æ –¥–∞—Ä–∏—Ç—å, –∏ —á—Ç–æ-—Ç–æ –æ—Ç –∫–æ–≥–æ-—Ç–æ –ø–æ–ª—É—á–∞—Ç—å.

–†–∞–∑–Ω–∏—Ü–∞ –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –æ–±–º–µ–Ω–∞ –ø–æ–¥–∞—Ä–∫–∞–º–∏ –ª–∏—à—å –≤ —Ç–æ–º, —á—Ç–æ –≤ –¢–∞–π–Ω–æ–º –°–∞–Ω—Ç–µ —Ç—ã –Ω–µ –±—É–¥–µ—à—å –∑–Ω–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ —Ç–µ–±–µ –ø–æ–¥–∞—Ä—è—Ç, –Ω–æ –∏ —Ç–æ, –∫—Ç–æ —Ç–µ–±–µ –±—É–¥–µ—Ç —á—Ç–æ-–ª–∏–±–æ –¥–∞—Ä–∏—Ç—å.        
–ò —ç—Ç–æ –±–µ–∑—É–º–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ ^-^
        `,
	}
}

export {
	greeterHandler,
	roomChooseNameHandler,
	createdRoomHandler,
	joinRoomHandler,
	joinedRoomHandler,
	failedToJoinRoomHandler,
	helpHandler,
}
